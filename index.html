<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íˆìŠ¤í† ë¦¬ ê³„ì‚°ê¸°</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            font-family: Arial, sans-serif;
        }
        .calculator {
            width: 350px;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            box-sizing: border-box;
        }
        #display {
            width: 100%;
            height: 50px;
            font-size: 20px;
            margin-bottom: 15px;
            padding: 10px;
            box-sizing: border-box;
            text-align: right;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #fafafa;
            display: block;
        }
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        button {
            padding: 15px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #e0e0e0;
        }
        .operator { background-color: #4CAF50; color: white; }
        .clear { background-color: #f44336; color: white; }
        button:active { opacity: 0.7; }
        .history-container { margin-top: 20px; }
        .history-title { font-size: 18px; margin-bottom: 10px; }
        .history-list {
            max-height: 150px;
            overflow-y: auto;
            background: #fafafa;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .history-item {
            font-size: 15px;
            padding: 5px;
            cursor: pointer;
        }
        .history-item:hover { background: #eee; }
        .modal-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.4);
            display: none;
            justify-content: center;
            align-items: center;
        }
        .modal-box {
            background: #fff;
            padding: 20px;
            width: 300px;
            border-radius: 10px;
            text-align: center;
            animation: fadeIn 0.3s;
        }
        .modal-title { font-size: 20px; margin-bottom: 10px; }
        .modal-result { font-size: 26px; font-weight: bold; margin-bottom: 20px; }
        .close-btn {
            padding: 10px 20px;
            background: #4CAF50;
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        @keyframes fadeIn { from { transform: scale(0.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>
    <div class="calculator">
        <input type="text" id="display" disabled>
        <div class="buttons">
            <button onclick="addValue('7')">7</button>
            <button onclick="addValue('8')">8</button>
            <button onclick="addValue('9')">9</button>
            <button class="operator" onclick="addValue('/')">/</button>
            <button onclick="addValue('4')">4</button>
            <button onclick="addValue('5')">5</button>
            <button onclick="addValue('6')">6</button>
            <button class="operator" onclick="addValue('*')">*</button>
            <button onclick="addValue('1')">1</button>
            <button onclick="addValue('2')">2</button>
            <button onclick="addValue('3')">3</button>
            <button class="operator" onclick="addValue('-')">-</button>
            <button onclick="addValue('0')">0</button>
            <button onclick="addValue('.')">.</button>
            <button class="clear" onclick="clearDisplay()">C</button>
            <button class="operator" onclick="addValue('+')">+</button>
            <button class="operator" style="grid-column: span 4;" onclick="calculate()">=</button>
        </div>
        <div class="history-container">
            <div class="history-title">ê³„ì‚° ê¸°ë¡</div>
            <div class="history-list" id="history"></div>
        </div>
    </div>

    <div class="modal-bg" id="modal">
        <div class="modal-box">
            <div class="modal-title">ê³„ì‚° ê²°ê³¼</div>
            <div class="modal-result" id="modal-result"></div>
            <button class="close-btn" onclick="closeModal()">í™•ì¸</button>
        </div>
    </div>

<script>
function addValue(value) {
    document.getElementById('display').value += value;
}
function clearDisplay() { document.getElementById('display').value = ''; }

function calculate() {
    const input = document.getElementById('display').value;
    const display = document.getElementById('display');
    if(input.trim() === "") {
        document.getElementById('modal-result').innerText = 0;
        document.getElementById('modal').style.display = 'flex';
        display.value = 0;
        addHistory("0 = 0");
        return;
    }
    try {
        const result = eval(input);
        document.getElementById('modal-result').innerText = result;
        document.getElementById('modal').style.display = 'flex';
        display.value = result;
        addHistory(input + " = " + result);
    } catch {
        display.value = "ì˜¤ë¥˜";
    }
}

function addHistory(text) {
    const historyList = document.getElementById('history');
    const item = document.createElement('div');
    item.className = 'history-item';
    item.innerText = text;
    item.onclick = () => {
        const formula = text.split("=")[0].trim();
        document.getElementById('display').value = formula;
    };
    historyList.prepend(item);
}

function closeModal() {
    document.getElementById('modal').style.display = 'none';
}

// ğŸ”¥ í‚¤ë³´ë“œ ì´ë²¤íŠ¸ & íŒì—… ë‹«ê¸° í†µí•©
document.addEventListener('keydown', function(e) {
    const key = e.key;

    // íŒì—…ì´ ì—´ë ¤ ìˆëŠ” ìƒíƒœì—ì„œ Enter â†’ ë‹«ê¸°
    if(key === "Enter" && document.getElementById('modal').style.display === 'flex') {
        closeModal();
        return;
    }

    // ESC â†’ íŒì—… ë‹«ê¸° ë˜ëŠ” ì „ì²´ ì´ˆê¸°í™”
    if(key === "Escape") {
        if(document.getElementById('modal').style.display === 'flex') {
            closeModal();
        } else {
            clearDisplay();
        }
        return;
    }

    // ìˆ«ì ë˜ëŠ” ì—°ì‚°ì ì…ë ¥
    if("0123456789+-*/.".includes(key)) { addValue(key); }

    // Enter â†’ ê³„ì‚° ì‹¤í–‰ (íŒì—…ì´ ì•ˆ ë–  ìˆì„ ë•Œ)
    if(key === "Enter") { calculate(); }

    // Backspace â†’ í•œ ê¸€ì ì‚­ì œ
    if(key === "Backspace") {
        const display = document.getElementById('display');
        display.value = display.value.slice(0, -1);
    }

    // C ë˜ëŠ” c â†’ ì „ì²´ í´ë¦¬ì–´
    if(key === "c" || key === "C") { clearDisplay(); }
});

// ğŸ”¥ íŒì—… ë°°ê²½ í´ë¦­ â†’ ë‹«ê¸°
document.getElementById('modal').addEventListener('click', function(e) {
    if(e.target === this) closeModal();
});
</script>
</body>
</html>
